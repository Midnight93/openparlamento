<?php
 
define('SF_ROOT_DIR',    realpath(dirname(__FILE__).'/..'));
define('SF_APP',         'fe');
define('SF_ENVIRONMENT', 'dev');
define('SF_DEBUG',       false);
 
require_once(SF_ROOT_DIR.DIRECTORY_SEPARATOR.'apps'.DIRECTORY_SEPARATOR.SF_APP.DIRECTORY_SEPARATOR.'config'.DIRECTORY_SEPARATOR.'config.php');
sfContext::getInstance();


$c= new Criteria();
$c->add(OppAttoPeer::ID, array(1564,1604,1666,1769,1917,2053,2065,2100,2103,2118,2131,2181,2185,2426,2442,2458,2540,2569,2586,2624,2701,3239,3240,3258,3731,3741,3750,3762,3763,3764,3765,3800,4042,4155,4297,4298,4360,4436,4474,4492,4563,4566,4587,4603,4629,4687,4691,4723,4725,4781,4816,4835,4836,4838,6860,6962,6963,6968,6983,7199,7375,7388,7515,7641,7648,7656,7657,7786,7837,7908,12621,12629,12669,12697,12712,12735,12759,12824,12828,12832,14620,14621,14846,15013,15014,15015,15093,15225,15469,15635,15751,15753,16125,16202,16290,16441,16581,16773,16778,17018,17035,17036,17040,17437,17476,17527,17706,17851,17857,18488,18621,18622,18713,19081,19171,19222,19269,19666,19667,19668,19673,19906,20271,20799,20837,20838,21322,21323,21356,21364,21365,21366,21367,21368,21369,21394,21395,21396,21495,21575,21608,21736,21737,21738,21742,21813,22109,22353,22564,22584,22722,22738,22815,23211,23212,23418,23730,23731,23732,23733,23852,23853,23854,23855,23856,23858,23859,23860,23861,23862,23863,23945,23946,23982,23986,23992,23993,24359,24360,24361,24362,24363,24365,24368,24369,24389,24390,24392,24479,24480,24717,24743,24891,24965,25155,25558,25618,25845,25846,25898,25899,25905,26245,26246,26392,26394,26792,26844,26845,26846,26847,26848,26849,26850,26851,26852,26853,26854,26855,26890,26891,27074,27231,27405,27408,27580,27581,27808,28011,28132,28434,28489,28571,28938,29510,29511,29512,29562,29591,29653,29822,29823,29824,29825,29828,30062,30146,30147,30217,30218,30220,30469,30664,30665,30920,30923,31003,31004,31005,31006,31045,31199,31204,31268,31356,31607,31835,31836,31941,32025,32186,32447,32528,32575,32576,32577,32578,32960,33085,33141,33398,33406,33407,33966,33969,33974,34015,34016,34017,34018,34115,34116,34182,34344,34453,34578,34655,34656,34658,34659,35921,35925,35958,36485,36509,36511,36816,36817,37210,37214,37217,37439,37444,38166,38167,38189,38551,38553,38583,38897,38900,38904,39303,39304,39665,39666,39667,39668,39669,39670,40040,40696,40697,40699,40944,40945,41146,41148,41149,41164,41166,41167,41170,42003,42004,42047,42152,42177,42730,43341,43342,43628,43657,43676,43677,43678,43679,43680,43681,43682,43692,43980,44755,44824,45037,45162,45174,45243,45244,45268,45470,45636,45911,45912,46236,46540,46589,46591,46592,46593,46595,46597,47182,47210,47211,47219,47995,47996,48083,48121,48359,48360,48405,48478,48657,48662,49117,49195,49196,49197,49198,49200,49457,49565,49808,49910,49911,49985,50493,50839,50840,51265,51266,51267,51269,51295,51391,51898,52198,52199,52200,52216,53244,53325,53326,53442,53597,54027,54141,54183,55273,55435,55436,55437,55611,55687,55806,56906,57466), Criteria::IN);
$results=OppAttoPeer::doSelect($c);
foreach ($results as $r)
{
	echo $r->getRamo()."\t".$r->getNumfase()."\t".$r->getTitolo()."\t".$r->getStatoFase()."\t".$r->getStatoLastDate()."\t";
	$c1= new Criteria();
	$c1->addJoin(OppAttoPeer::ID,OppVotazioneHasAttoPeer::ATTO_ID);
	$c1->addJoin(OppVotazionePeer::ID,OppVotazioneHasGruppoPeer::VOTAZIONE_ID);
	$c1->addJoin(OppVotazionePeer::ID,OppVotazioneHasAttoPeer::VOTAZIONE_ID);
	$c1->addJoin(OppGruppoPeer::ID,OppVotazioneHasGruppoPeer::GRUPPO_ID);
	$c1->add(OppVotazionePeer::FINALE,1);
	$c1->add(OppAttoPeer::ID,$r->getId());
	$res1=OppVotazioneHasGruppoPeer::doSelect($c1);
	if (count($res1)>0)
	{
		foreach ($res1 as $k => $r1)
		{
			if ($k==0)
				echo $r1->getOppVotazione()->getMargine()."\t".$r1->getOppVotazione()->getRibelli()."\t";
			echo $r1->getOppGruppo()->getNome()."\t".$r1->getVoto();
			if ($k<count($res1)-1)
				echo "\t";
			else
				echo "\n";
			
		}
	}
	else
		echo "\n";
}


?>